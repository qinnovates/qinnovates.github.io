---
import PageLayout from '../layouts/PageLayout.astro';
import { categories, briefs } from '../lib/news-data';
---

<PageLayout
  title="News & Intel"
  description="BCI security intelligence — curated news, research, and analysis across neurotechnology, quantum computing, and neuroethics."
  breadcrumbs={[{ label: 'News & Intel' }]}
  maxWidth="wide"
>
  <div class="mb-12 reveal">
    <h1 class="text-3xl sm:text-4xl font-bold font-[family-name:var(--font-heading)] mb-4">News & Intel</h1>
    <p class="text-lg text-[var(--color-text-muted)] max-w-3xl">
      Curated intelligence across the BCI security landscape. Tracking developments in neurotechnology, quantum computing, neuroethics, and adversarial research — with QIF relevance analysis.
    </p>
  </div>

  <!-- Intelligence Briefs -->
  <section class="mb-16">
    <h2 class="text-xl font-semibold font-[family-name:var(--font-heading)] mb-6 reveal">Intelligence Briefs</h2>
    <div class="space-y-4 reveal">
      {briefs.map((brief) => {
        const cat = categories.find(c => c.id === brief.category);
        return (
          <div class="glass rounded-xl p-6" style={`border-left: 3px solid ${cat ? `${cat.color}` : 'var(--color-border)'};`}>
            <div class="flex items-start justify-between gap-4 mb-3">
              <h3 class="text-base font-semibold font-[family-name:var(--font-heading)]">{brief.title}</h3>
              <div class="flex items-center gap-2 shrink-0">
                <span class="text-xs px-2 py-0.5 rounded-full border border-[var(--color-border)] text-[var(--color-text-faint)]">
                  {cat?.name}
                </span>
                <span class="text-xs text-[var(--color-text-faint)] font-[family-name:var(--font-mono)]">{brief.date}</span>
              </div>
            </div>
            <p class="text-sm text-[var(--color-text-muted)] mb-3">{brief.summary}</p>
            <div class="text-xs text-[var(--color-accent-secondary)] bg-[var(--color-accent-secondary)]/5 rounded-lg px-3 py-2">
              <strong>QIF Relevance:</strong> {brief.relevance}
            </div>
          </div>
        );
      })}
    </div>
  </section>

  <!-- Source Categories -->
  <section>
    <h2 class="text-xl font-semibold font-[family-name:var(--font-heading)] mb-6 reveal">Intelligence Sources</h2>
    <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6 reveal reveal-stagger">
      {categories.map((cat) => (
        <div class="glass rounded-xl p-6">
          <div class="flex items-center gap-3 mb-3">
            <span class="text-xl" style={`color: ${cat.color};`} set:html={cat.icon} />
            <h3 class="text-base font-semibold font-[family-name:var(--font-heading)]">{cat.name}</h3>
          </div>
          <p class="text-sm text-[var(--color-text-muted)] mb-4">{cat.description}</p>
          <ul class="space-y-2">
            {cat.sources.map((src) => (
              <li>
                <a
                  href={src.url}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="text-sm text-[var(--color-accent-primary)] hover:text-[var(--color-accent-secondary)] transition-colors flex items-center gap-1.5"
                >
                  {src.name}
                  <svg class="w-3 h-3 opacity-50" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25" />
                  </svg>
                </a>
              </li>
            ))}
          </ul>
        </div>
      ))}
    </div>
  </section>

  <!-- Subscribe Section -->
  <div class="mt-16 glass rounded-xl p-8 reveal">
    <div class="max-w-xl mx-auto text-center">
      <h2 class="text-xl font-semibold font-[family-name:var(--font-heading)] mb-2">Stay Informed</h2>
      <p class="text-sm text-[var(--color-text-muted)] mb-6">
        No spam. Neural security intel, delivered when it matters.
      </p>

      <form
        action="https://buttondown.com/api/emails/embed-subscribe/qinnovate"
        method="post"
        target="_blank"
        class="flex flex-col sm:flex-row gap-3 mb-4"
      >
        <input
          type="email"
          name="email"
          placeholder="your@email.com"
          required
          class="flex-1 px-4 py-2.5 rounded-lg bg-[var(--color-bg-secondary)] border border-[var(--color-border)] text-[var(--color-text-primary)] placeholder:text-[var(--color-text-faint)] text-sm focus:outline-none focus:border-[var(--color-accent-primary)] transition-colors"
        />
        <button
          type="submit"
          class="px-6 py-2.5 rounded-lg bg-[var(--color-accent-primary)] text-[var(--color-bg-primary)] text-sm font-semibold hover:opacity-90 transition-opacity cursor-pointer"
        >
          Subscribe
        </button>
      </form>

      <a
        href="/rss.xml"
        class="inline-flex items-center gap-1.5 text-sm text-[var(--color-text-muted)] hover:text-[var(--color-accent-primary)] transition-colors"
      >
        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
          <path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1Z"/>
        </svg>
        Subscribe via RSS
      </a>
    </div>
  </div>
</PageLayout>
