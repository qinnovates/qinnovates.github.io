<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QInnovate — Securing the Neural Frontier</title>
  <meta name="description" content="QInnovate pioneers neuroethics frameworks and BCI security research. Advancing brain-computer interface security through rigorous research, ethical frameworks, and open-source tools.">
  <meta property="og:title" content="QInnovate — Securing the Neural Frontier">
  <meta property="og:description" content="Pioneering neuroethics frameworks and BCI security research. Home of the ONI Framework — a comprehensive 14-layer security model for brain-computer interfaces.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://qinnovates.github.io">
  <meta property="og:image" content="https://qinnovates.github.io/og-image.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="QInnovate — Securing the Neural Frontier">
  <meta name="twitter:description" content="Pioneering neuroethics frameworks and BCI security research.">
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%230a0a0f'/><text x='50' y='62' font-family='Arial' font-size='48' font-weight='bold' fill='%2300e5ff' text-anchor='middle'>Q</text></svg>">

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DKB9RWW0C2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-DKB9RWW0C2');
  </script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- Three.js -->
  <script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>

  <!-- GSAP + ScrollTrigger -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

  <style>
    *, *::before, *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg-primary: #0a0a0f;
      --bg-secondary: #0e0e16;
      --bg-card: #12121c;
      --bg-card-hover: #181826;
      --cyan: #00e5ff;
      --cyan-dim: #00a2b3;
      --purple: #b44aff;
      --purple-dim: #7b2fbf;
      --text-primary: #e8e8ef;
      --text-secondary: #8888a0;
      --text-muted: #55556a;
      --border: #1e1e30;
      --glow-cyan: 0 0 30px rgba(0, 229, 255, 0.3);
      --glow-purple: 0 0 30px rgba(180, 74, 255, 0.3);
      --gradient-accent: linear-gradient(135deg, var(--cyan), var(--purple));
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
    }

    /* -- Three.js Canvas Background -- */
    #three-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 0;
      pointer-events: none;
    }

    /* -- Navigation -- */
    .nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
      padding: 1rem 2rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: rgba(10, 10, 15, 0.8);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(30, 30, 48, 0.5);
      transition: background 0.3s ease;
    }

    .nav.scrolled {
      background: rgba(10, 10, 15, 0.95);
    }

    .nav-logo {
      font-size: 1.4rem;
      font-weight: 800;
      letter-spacing: -0.02em;
      background: var(--gradient-accent);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-decoration: none;
    }

    .nav-links {
      display: flex;
      gap: 2rem;
      list-style: none;
      align-items: center;
    }

    .nav-links a {
      color: var(--text-secondary);
      text-decoration: none;
      font-size: 0.9rem;
      font-weight: 500;
      transition: color 0.3s ease;
      position: relative;
    }

    .nav-links a:hover {
      color: var(--cyan);
    }

    .nav-links a::after {
      content: '';
      position: absolute;
      bottom: -4px;
      left: 0;
      width: 0;
      height: 2px;
      background: var(--gradient-accent);
      transition: width 0.3s ease;
    }

    .nav-links a:hover::after {
      width: 100%;
    }

    .hamburger {
      display: none;
      flex-direction: column;
      gap: 5px;
      cursor: pointer;
      padding: 4px;
      background: none;
      border: none;
    }

    .hamburger span {
      display: block;
      width: 24px;
      height: 2px;
      background: var(--text-secondary);
      transition: all 0.3s ease;
    }

    .hamburger.active span:nth-child(1) {
      transform: rotate(45deg) translate(5px, 5px);
    }
    .hamburger.active span:nth-child(2) {
      opacity: 0;
    }
    .hamburger.active span:nth-child(3) {
      transform: rotate(-45deg) translate(5px, -5px);
    }

    /* -- Sections -- */
    section {
      position: relative;
      z-index: 1;
    }

    .container {
      max-width: 1120px;
      margin: 0 auto;
      padding: 0 2rem;
    }

    /* -- GSAP fade-up (replaces IntersectionObserver) -- */
    .fade-up {
      opacity: 0;
      transform: translateY(30px);
    }

    .section-label {
      display: inline-block;
      font-size: 0.75rem;
      font-weight: 600;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: var(--cyan);
      margin-bottom: 1rem;
      position: relative;
      padding-left: 2rem;
    }

    .section-label::before {
      content: '';
      position: absolute;
      left: 0;
      top: 50%;
      width: 1.2rem;
      height: 1px;
      background: var(--cyan);
    }

    .section-title {
      font-size: 2.4rem;
      font-weight: 700;
      letter-spacing: -0.03em;
      line-height: 1.2;
      margin-bottom: 1.5rem;
    }

    /* -- Hero -- */
    .hero {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 8rem 2rem 4rem;
      position: relative;
    }

    .hero-content {
      max-width: 800px;
      position: relative;
      z-index: 2;
    }

    .hero-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.4rem 1rem;
      border: 1px solid var(--border);
      border-radius: 100px;
      font-size: 0.8rem;
      color: var(--text-secondary);
      margin-bottom: 2rem;
      background: rgba(18, 18, 28, 0.6);
    }

    .hero-badge-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--cyan);
      box-shadow: 0 0 8px var(--cyan);
      animation: pulse-dot 2s ease-in-out infinite;
    }

    @keyframes pulse-dot {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.4; }
    }

    .hero h1 {
      font-size: clamp(3rem, 8vw, 5.5rem);
      font-weight: 800;
      letter-spacing: -0.04em;
      line-height: 1;
      margin-bottom: 1.5rem;
      background: linear-gradient(135deg, #ffffff 0%, var(--cyan) 50%, var(--purple) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: shimmer 8s ease-in-out infinite;
      background-size: 200% 200%;
    }

    @keyframes shimmer {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .hero-tagline {
      font-size: clamp(1.1rem, 2.5vw, 1.4rem);
      font-weight: 300;
      color: var(--text-secondary);
      margin-bottom: 0.75rem;
      letter-spacing: 0.02em;
    }

    .hero-subtitle {
      font-size: clamp(0.9rem, 1.5vw, 1.05rem);
      color: var(--text-muted);
      max-width: 550px;
      margin: 0 auto 2.5rem;
      line-height: 1.7;
    }

    .cta-group {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.85rem 2rem;
      border-radius: 8px;
      font-size: 0.95rem;
      font-weight: 600;
      text-decoration: none;
      transition: all 0.3s ease;
      cursor: pointer;
      border: none;
      font-family: inherit;
    }

    .btn-primary {
      background: var(--gradient-accent);
      color: var(--bg-primary);
      box-shadow: 0 4px 20px rgba(0, 229, 255, 0.2);
    }

    .btn-primary:hover {
      box-shadow: 0 4px 30px rgba(0, 229, 255, 0.4);
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: transparent;
      color: var(--text-primary);
      border: 1px solid var(--border);
    }

    .btn-secondary:hover {
      border-color: var(--cyan-dim);
      color: var(--cyan);
      transform: translateY(-2px);
    }

    .btn-arrow {
      transition: transform 0.3s ease;
    }

    .btn:hover .btn-arrow {
      transform: translateX(3px);
    }

    .scroll-indicator {
      position: absolute;
      bottom: 2rem;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
      color: var(--text-muted);
      font-size: 0.75rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateX(-50%) translateY(0); }
      50% { transform: translateX(-50%) translateY(-8px); }
    }

    .scroll-line {
      width: 1px;
      height: 40px;
      background: linear-gradient(to bottom, var(--cyan-dim), transparent);
    }

    /* -- About -- */
    .about {
      padding: 8rem 0;
    }

    .about-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 4rem;
      align-items: start;
    }

    .about-text p {
      font-size: 1.05rem;
      color: var(--text-secondary);
      line-height: 1.8;
      margin-bottom: 1.5rem;
    }

    .stats-grid {
      display: grid;
      gap: 1.25rem;
    }

    .stat-card {
      padding: 1.5rem;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 12px;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: var(--gradient-accent);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .stat-card:hover {
      border-color: rgba(0, 229, 255, 0.2);
      background: var(--bg-card-hover);
      transform: translateY(-2px);
    }

    .stat-card:hover::before {
      opacity: 1;
    }

    .stat-number {
      font-size: 1.8rem;
      font-weight: 800;
      background: var(--gradient-accent);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 0.25rem;
    }

    .stat-label {
      font-size: 0.95rem;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 0.3rem;
    }

    .stat-desc {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    /* -- Projects -- */
    .projects {
      padding: 8rem 0;
      background: linear-gradient(180deg, transparent, rgba(14, 14, 22, 0.5), transparent);
    }

    .projects-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1.5rem;
      margin-top: 3rem;
    }

    .project-card {
      padding: 2rem;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 16px;
      transition: all 0.4s ease;
      display: flex;
      flex-direction: column;
      position: relative;
      overflow: hidden;
      text-decoration: none;
      color: inherit;
    }

    .project-card::after {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: 16px;
      padding: 1px;
      background: var(--gradient-accent);
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      opacity: 0;
      transition: opacity 0.4s ease;
    }

    .project-card:hover {
      transform: translateY(-4px);
      background: var(--bg-card-hover);
    }

    .project-card:hover::after {
      opacity: 1;
    }

    .project-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.4rem;
      margin-bottom: 1.25rem;
      background: rgba(0, 229, 255, 0.08);
      border: 1px solid rgba(0, 229, 255, 0.15);
    }

    .project-card:nth-child(2) .project-icon {
      background: rgba(180, 74, 255, 0.08);
      border-color: rgba(180, 74, 255, 0.15);
    }

    .project-card:nth-child(3) .project-icon {
      background: rgba(0, 229, 255, 0.06);
      border-color: rgba(0, 229, 255, 0.1);
    }

    .project-card h3 {
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: 0.75rem;
      letter-spacing: -0.01em;
    }

    .project-card p {
      font-size: 0.9rem;
      color: var(--text-secondary);
      line-height: 1.7;
      flex: 1;
      margin-bottom: 1.25rem;
    }

    .project-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 1.25rem;
    }

    .tag {
      padding: 0.25rem 0.7rem;
      font-size: 0.7rem;
      font-weight: 600;
      border-radius: 100px;
      background: rgba(0, 229, 255, 0.06);
      color: var(--cyan-dim);
      border: 1px solid rgba(0, 229, 255, 0.1);
      letter-spacing: 0.02em;
    }

    .project-card:nth-child(2) .tag {
      background: rgba(180, 74, 255, 0.06);
      color: var(--purple-dim);
      border-color: rgba(180, 74, 255, 0.1);
    }

    .project-link {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--cyan);
      text-decoration: none;
      transition: gap 0.3s ease;
    }

    .project-link:hover {
      gap: 0.7rem;
    }

    .project-link.coming-soon {
      color: var(--text-muted);
    }

    /* -- Team -- */
    .team {
      padding: 8rem 0;
    }

    .founder-card {
      max-width: 700px;
      margin: 3rem auto 0;
      display: flex;
      gap: 2.5rem;
      align-items: start;
      padding: 2.5rem;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 20px;
      transition: all 0.3s ease;
    }

    .founder-card:hover {
      border-color: rgba(0, 229, 255, 0.15);
    }

    .founder-avatar {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      flex-shrink: 0;
      background: var(--gradient-accent);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.2rem;
      font-weight: 800;
      color: var(--bg-primary);
      position: relative;
    }

    .founder-avatar::after {
      content: '';
      position: absolute;
      inset: -3px;
      border-radius: 50%;
      background: var(--gradient-accent);
      z-index: -1;
      opacity: 0.3;
      filter: blur(8px);
    }

    .founder-info h3 {
      font-size: 1.4rem;
      font-weight: 700;
      margin-bottom: 0.25rem;
    }

    .founder-role {
      font-size: 0.85rem;
      color: var(--cyan);
      font-weight: 600;
      margin-bottom: 1rem;
    }

    .founder-bio {
      font-size: 0.95rem;
      color: var(--text-secondary);
      line-height: 1.7;
      margin-bottom: 1.25rem;
    }

    .founder-links {
      display: flex;
      gap: 1rem;
    }

    .founder-links a {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 0.85rem;
      color: var(--text-muted);
      text-decoration: none;
      transition: color 0.3s ease;
    }

    .founder-links a:hover {
      color: var(--cyan);
    }

    .founder-links svg {
      width: 16px;
      height: 16px;
    }

    /* -- Footer -- */
    .footer {
      padding: 3rem 0;
      border-top: 1px solid var(--border);
    }

    .footer-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .footer-left p {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .footer-left p:first-child {
      color: var(--text-secondary);
      font-weight: 500;
      margin-bottom: 0.25rem;
    }

    .footer-tagline {
      font-size: 0.8rem;
      color: var(--text-muted);
      font-style: italic;
    }

    .footer-links {
      display: flex;
      gap: 1.5rem;
    }

    .footer-links a {
      font-size: 0.85rem;
      color: var(--text-muted);
      text-decoration: none;
      transition: color 0.3s ease;
    }

    .footer-links a:hover {
      color: var(--cyan);
    }

    /* -- Mobile -- */
    .mobile-nav {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(10, 10, 15, 0.98);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      z-index: 999;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 2rem;
    }

    .mobile-nav.open {
      display: flex;
    }

    .mobile-nav a {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--text-primary);
      text-decoration: none;
      transition: color 0.3s ease;
    }

    .mobile-nav a:hover {
      color: var(--cyan);
    }

    @media (max-width: 900px) {
      .projects-grid {
        grid-template-columns: 1fr;
        max-width: 500px;
        margin-left: auto;
        margin-right: auto;
      }

      .about-grid {
        grid-template-columns: 1fr;
        gap: 3rem;
      }
    }

    @media (max-width: 768px) {
      .nav-links {
        display: none;
      }

      .hamburger {
        display: flex;
        z-index: 1001;
      }

      .hero h1 {
        font-size: clamp(2.5rem, 10vw, 3.5rem);
      }

      .section-title {
        font-size: 1.8rem;
      }

      .founder-card {
        flex-direction: column;
        align-items: center;
        text-align: center;
        padding: 2rem 1.5rem;
      }

      .founder-links {
        justify-content: center;
      }

      .footer-content {
        flex-direction: column;
        text-align: center;
      }

      .scroll-indicator {
        display: none;
      }

      .container {
        padding: 0 1.25rem;
      }
    }

    /* -- Selection -- */
    ::selection {
      background: rgba(0, 229, 255, 0.2);
      color: #fff;
    }

    /* -- Accessibility Toggle -- */
    .a11y-toggle {
      position: fixed;
      bottom: 1.5rem;
      right: 1.5rem;
      z-index: 1001;
      display: flex;
      align-items: center;
      gap: 0.6rem;
      padding: 0.6rem 1.2rem;
      background: rgba(18, 18, 28, 0.95);
      border: 1px solid var(--cyan-dim);
      border-radius: 100px;
      cursor: pointer;
      font-family: inherit;
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--cyan);
      transition: all 0.3s ease;
      -webkit-user-select: none;
      user-select: none;
      box-shadow: 0 0 15px rgba(0, 229, 255, 0.15), 0 4px 12px rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }

    .a11y-toggle:hover {
      border-color: var(--cyan);
      color: #fff;
      box-shadow: 0 0 25px rgba(0, 229, 255, 0.3), 0 4px 16px rgba(0, 0, 0, 0.5);
    }

    .a11y-toggle:focus-visible {
      outline: 2px solid var(--cyan);
      outline-offset: 2px;
    }

    .a11y-icon {
      font-size: 1.1rem;
      line-height: 1;
    }

    .a11y-toggle-track {
      width: 36px;
      height: 20px;
      border-radius: 100px;
      background: var(--border);
      position: relative;
      transition: background 0.3s ease;
    }

    .a11y-toggle-track::after {
      content: '';
      position: absolute;
      top: 3px;
      left: 3px;
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: var(--text-muted);
      transition: all 0.3s ease;
    }

    .a11y-toggle.effects-on .a11y-toggle-track {
      background: var(--cyan-dim);
    }

    .a11y-toggle.effects-on .a11y-toggle-track::after {
      left: 19px;
      background: var(--cyan);
      box-shadow: 0 0 6px var(--cyan);
    }

    .a11y-toggle.effects-on {
      border-color: var(--border);
      color: var(--text-secondary);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    .a11y-toggle.effects-on:hover {
      border-color: var(--cyan-dim);
      color: var(--text-primary);
    }

    /* -- Accessible Mode (default) -- */

    body:not(.effects-enabled) .fade-up {
      opacity: 1;
      transform: none;
    }

    body:not(.effects-enabled) .hero h1 {
      animation: none;
      background: var(--gradient-accent);
      -webkit-background-clip: text;
      background-clip: text;
    }

    body:not(.effects-enabled) .hero-badge-dot {
      animation: none;
    }

    body:not(.effects-enabled) .scroll-indicator {
      animation: none;
    }

    body:not(.effects-enabled) .project-card:hover,
    body:not(.effects-enabled) .stat-card:hover,
    body:not(.effects-enabled) .founder-card:hover {
      transform: none;
    }

    /* -- Skip to content link (screen readers) -- */
    .skip-link {
      position: absolute;
      top: -100px;
      left: 0;
      background: var(--cyan);
      color: var(--bg-primary);
      padding: 0.75rem 1.5rem;
      z-index: 10000;
      font-weight: 600;
      text-decoration: none;
      border-radius: 0 0 8px 0;
    }

    .skip-link:focus {
      top: 0;
    }

    /* -- prefers-reduced-motion override -- */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }

      #three-canvas {
        display: none;
      }

      .fade-up {
        opacity: 1;
        transform: none;
      }
    }
  </style>
</head>
<body>

  <a href="#about" class="skip-link">Skip to main content</a>

  <div id="three-canvas" aria-hidden="true"></div>

  <!-- Accessibility toggle -->
  <button class="a11y-toggle" id="a11y-toggle" aria-label="Toggle BCI-accessible mode" title="Toggle BCI-accessible mode">
    <span class="a11y-icon" aria-hidden="true">&#9881;</span>
    <span class="a11y-label">BCI Accessible</span>
    <span class="a11y-toggle-track"></span>
  </button>

  <!-- Navigation -->
  <nav class="nav" id="nav">
    <a href="#" class="nav-logo">QInnovate</a>
    <ul class="nav-links">
      <li><a href="#about">About</a></li>
      <li><a href="/mindloft/">Research</a></li>
      <li><a href="#projects">Projects</a></li>
      <li><a href="#team">Team</a></li>
      <li><a href="https://github.com/qinnovates/mindloft" target="_blank" rel="noopener">GitHub</a></li>
    </ul>
    <button class="hamburger" id="hamburger" aria-label="Menu">
      <span></span>
      <span></span>
      <span></span>
    </button>
  </nav>

  <!-- Mobile Navigation -->
  <div class="mobile-nav" id="mobile-nav">
    <a href="#about" onclick="closeMobileNav()">About</a>
    <a href="/mindloft/" onclick="closeMobileNav()">Research</a>
    <a href="#projects" onclick="closeMobileNav()">Projects</a>
    <a href="#team" onclick="closeMobileNav()">Team</a>
    <a href="https://github.com/qinnovates/mindloft" target="_blank" rel="noopener" onclick="closeMobileNav()">GitHub</a>
  </div>

  <!-- Hero -->
  <section class="hero" id="hero">
    <div class="hero-content fade-up">
      <div class="hero-badge">
        <span class="hero-badge-dot"></span>
        Neuroethics &amp; BCI Security
      </div>
      <h1>QInnovate</h1>
      <p class="hero-tagline">Securing the Neural Frontier</p>
      <p class="hero-subtitle">Pioneering neuroethics frameworks and BCI security research to protect the next generation of brain-computer interfaces.</p>
      <div class="cta-group">
        <a href="#projects" class="btn btn-primary">
          Explore Projects
          <span class="btn-arrow">&rarr;</span>
        </a>
        <a href="https://github.com/qinnovates/mindloft" target="_blank" rel="noopener" class="btn btn-secondary">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
          GitHub
        </a>
      </div>
    </div>
    <div class="scroll-indicator">
      <span>Scroll</span>
      <div class="scroll-line"></div>
    </div>
  </section>

  <!-- About -->
  <section class="about" id="about" role="main">
    <div class="container">
      <div class="about-grid">
        <div class="about-text fade-up">
          <span class="section-label">About</span>
          <h2 class="section-title">Building trust in the neural age</h2>
          <p>QInnovate advances brain-computer interface security through rigorous research, ethical frameworks, and open-source tools. As BCI technology accelerates from laboratory to consumer, the gap between capability and security widens.</p>
          <p>We bridge that gap. Our work spans threat modeling, security architecture, and neuroethics policy -- creating the foundational standards that protect neural data privacy and cognitive autonomy.</p>
        </div>
        <div class="stats-grid fade-up">
          <div class="stat-card">
            <div class="stat-number">14</div>
            <div class="stat-label">Layer Security Model</div>
            <div class="stat-desc">Comprehensive architecture from hardware to application layer security for neural interfaces.</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">46+</div>
            <div class="stat-label">Threat Techniques Catalogued</div>
            <div class="stat-desc">Systematically mapped attack vectors specific to brain-computer interface systems.</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">&lt;/&gt;</div>
            <div class="stat-label">Open Source Framework</div>
            <div class="stat-desc">Freely available tools, visualizations, and documentation for the research community.</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Projects -->
  <section class="projects" id="projects">
    <div class="container">
      <div class="fade-up" style="text-align:center; max-width: 600px; margin: 0 auto 1rem;">
        <span class="section-label">Projects</span>
        <h2 class="section-title">What we're building</h2>
        <p style="color: var(--text-secondary); font-size: 1rem; line-height: 1.7;">Open-source frameworks and research tools advancing the state of BCI security.</p>
      </div>
      <div class="projects-grid">
        <a href="/mindloft/" class="project-card fade-up">
          <div class="project-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
          </div>
          <h3>QIF — pronounced "CHIEF"</h3>
          <p>Quantum Indeterministic Framework for Neural Security. A comprehensive 14-layer security model for brain-computer interfaces.</p>
          <div class="project-tags">
            <span class="tag">BCI Security</span>
            <span class="tag">Neuroethics</span>
            <span class="tag">Open Source</span>
          </div>
          <span class="project-link">
            Explore framework <span class="btn-arrow">&rarr;</span>
          </span>
        </a>
        <div class="project-card fade-up">
          <div class="project-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--purple)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
          </div>
          <h3>Research</h3>
          <p>Publications on neural firewall design, coherence metrics, and quantum-secured BCI communications.</p>
          <div class="project-tags">
            <span class="tag">Publications</span>
            <span class="tag">Papers</span>
          </div>
          <span class="project-link coming-soon">
            Coming soon
          </span>
        </div>
        <a href="/mindloft/visualizations/" class="project-card fade-up">
          <div class="project-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--cyan)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
          </div>
          <h3>Tools</h3>
          <p>Interactive visualizations and security analysis tools for BCI threat modeling and framework exploration.</p>
          <div class="project-tags">
            <span class="tag">Visualizations</span>
            <span class="tag">Analysis</span>
          </div>
          <span class="project-link">
            Launch tools <span class="btn-arrow">&rarr;</span>
          </span>
        </a>
      </div>
    </div>
  </section>

  <!-- Team -->
  <section class="team" id="team">
    <div class="container">
      <div class="fade-up" style="text-align:center;">
        <span class="section-label">Team</span>
        <h2 class="section-title">Who we are</h2>
      </div>
      <div class="founder-card fade-up">
        <div class="founder-avatar">KQ</div>
        <div class="founder-info">
          <h3>Kevin Qi</h3>
          <div class="founder-role">Founder &amp; Lead Researcher</div>
          <p class="founder-bio">BCI security researcher focused on building ethical frameworks for neural interfaces. Background in neuroscience and cybersecurity, working at the intersection of emerging technology and human rights.</p>
          <div style="margin-bottom: 12px;">
            <iframe src="https://github.com/sponsors/qikevinl/button" title="Sponsor qikevinl" height="32" width="114" style="border: 0; border-radius: 6px;"></iframe>
          </div>
          <div class="founder-links">
            <a href="https://github.com/qikevinl" target="_blank" rel="noopener">
              <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
              GitHub
            </a>
            <a href="https://medium.com/@qikevinl" target="_blank" rel="noopener">
              <svg viewBox="0 0 24 24" fill="currentColor"><path d="M13.54 12a6.8 6.8 0 01-6.77 6.82A6.8 6.8 0 010 12a6.8 6.8 0 016.77-6.82A6.8 6.8 0 0113.54 12zm7.42 0c0 3.54-1.51 6.42-3.38 6.42-1.87 0-3.39-2.88-3.39-6.42s1.52-6.42 3.39-6.42 3.38 2.88 3.38 6.42M24 12c0 3.17-.53 5.75-1.19 5.75-.66 0-1.19-2.58-1.19-5.75s.53-5.75 1.19-5.75C23.47 6.25 24 8.83 24 12z"/></svg>
              Medium
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-left">
          <p>&copy; 2026 QInnovate</p>
          <p class="footer-tagline">Securing the Neural Frontier</p>
        </div>
        <div class="footer-links">
          <a href="/mindloft/">Research</a>
          <a href="https://github.com/qinnovates/mindloft" target="_blank" rel="noopener">GitHub</a>
          <a href="https://qinnovate.com/mindloft/legacy/" target="_blank" rel="noopener">Legacy: ONI v1</a>
          <a href="#hero">Back to top</a>
        </div>
      </div>
    </div>
  </footer>

  <script>
    /* =============================================
       ACCESSIBILITY TOGGLE
       ============================================= */
    (function() {
      var toggle = document.getElementById('a11y-toggle');
      var prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      var effectsOn = localStorage.getItem('qinnovate-effects');

      if (prefersReduced) {
        effectsOn = false;
      } else if (effectsOn === null) {
        effectsOn = false;
      } else {
        effectsOn = effectsOn === 'true';
      }

      var label = toggle.querySelector('.a11y-label');

      function applyEffects(on) {
        document.body.classList.toggle('effects-enabled', on);
        toggle.classList.toggle('effects-on', on);
        toggle.setAttribute('aria-pressed', on);
        label.textContent = on ? 'Effects On' : 'BCI Accessible';
        if (on) {
          window.dispatchEvent(new CustomEvent('effects-on'));
        } else {
          window.dispatchEvent(new CustomEvent('effects-off'));
        }
      }

      applyEffects(effectsOn);

      toggle.addEventListener('click', function() {
        effectsOn = !effectsOn;
        localStorage.setItem('qinnovate-effects', effectsOn);
        applyEffects(effectsOn);
      });
    })();

    /* =============================================
       GSAP SCROLL ANIMATIONS
       ============================================= */
    (function() {
      var gsapReady = typeof gsap !== 'undefined' && typeof ScrollTrigger !== 'undefined';
      if (!gsapReady) return;

      gsap.registerPlugin(ScrollTrigger);

      var effectsEnabled = document.body.classList.contains('effects-enabled');

      function initGSAP() {
        // Fade-up animations for all .fade-up elements
        gsap.utils.toArray('.fade-up').forEach(function(el, i) {
          gsap.fromTo(el, {
            opacity: 0,
            y: 30
          }, {
            scrollTrigger: {
              trigger: el,
              start: 'top 85%',
              toggleActions: 'play none none none'
            },
            opacity: 1,
            y: 0,
            duration: 0.8,
            delay: i % 3 === 0 ? 0 : (i % 3) * 0.15,
            ease: 'power2.out'
          });
        });

        // Scroll indicator fade
        gsap.to('.scroll-indicator', {
          scrollTrigger: {
            trigger: '#hero',
            start: '20% top',
            end: '40% top',
            scrub: 1
          },
          opacity: 0
        });
      }

      function killGSAP() {
        ScrollTrigger.getAll().forEach(function(st) { st.kill(); });
        // Make all fade-up elements visible
        document.querySelectorAll('.fade-up').forEach(function(el) {
          el.style.opacity = '1';
          el.style.transform = 'none';
        });
      }

      if (effectsEnabled) {
        initGSAP();
      } else {
        // Ensure everything is visible
        document.querySelectorAll('.fade-up').forEach(function(el) {
          el.style.opacity = '1';
          el.style.transform = 'none';
        });
      }

      window.addEventListener('effects-on', function() {
        // Reset elements to hidden state before animating
        document.querySelectorAll('.fade-up').forEach(function(el) {
          el.style.opacity = '';
          el.style.transform = '';
        });
        initGSAP();
        ScrollTrigger.refresh();
      });

      window.addEventListener('effects-off', function() {
        killGSAP();
      });
    })();

    /* =============================================
       THREE.JS: 14-LAYER CONCENTRIC SPHERES
       ============================================= */
    (function() {
      var threeContainer = document.getElementById('three-canvas');
      if (!threeContainer || typeof THREE === 'undefined') return;

      var renderer, scene, camera, autoRotateGroup, parallaxGroup;
      var shellMeshes = [], shellUniforms = [];
      var dustCloud;
      var clock;
      var animId = null;
      var running = false;

      var isMobile = window.innerWidth <= 768;

      // QInnovate palette: cyan (#00e5ff) to purple (#b44aff)
      // 14 layers: bottom (L1/outermost) = cyan, top (L14/innermost) = purple
      // We show 7 layers on hero (L8-L14) like ONI's biology layers
      var layerConfigs = [
        { id:'L8',  r:1.72, c:[0.00, 0.60, 0.70], fp:2.0 },  // cyan-teal (gateway)
        { id:'L9',  r:1.52, c:[0.00, 0.78, 0.85], fp:2.8 },  // bright cyan
        { id:'L10', r:1.38, c:[0.15, 0.72, 0.90], fp:2.6 },  // cyan-blue
        { id:'L11', r:1.24, c:[0.30, 0.55, 0.92], fp:2.4 },  // blue-cyan
        { id:'L12', r:1.10, c:[0.45, 0.40, 0.90], fp:2.3 },  // blue-purple
        { id:'L13', r:0.96, c:[0.58, 0.30, 0.88], fp:2.2 },  // purple-blue
        { id:'L14', r:0.82, c:[0.71, 0.29, 1.00], fp:2.0 },  // vivid purple
      ];

      var mobileIdx = [0, 2, 4, 6];
      var activeLayers = isMobile ? mobileIdx.map(function(i) { return layerConfigs[i]; }) : layerConfigs;
      var originalRadii = activeLayers.map(function(l) { return l.r; });
      var totalLayers = activeLayers.length;

      // Fresnel shader
      var fresnelVert = [
        'varying vec3 vNormal;',
        'varying vec3 vViewPos;',
        'varying vec3 vWorldPos;',
        'void main() {',
        '  vNormal = normalize(normalMatrix * normal);',
        '  vec4 mv = modelViewMatrix * vec4(position, 1.0);',
        '  vViewPos = -mv.xyz;',
        '  vWorldPos = (modelMatrix * vec4(position, 1.0)).xyz;',
        '  gl_Position = projectionMatrix * mv;',
        '}'
      ].join('\n');

      var fresnelFrag = [
        'uniform vec3 uColor;',
        'uniform float uOpacity;',
        'uniform float uFresnelPower;',
        'uniform float uGlowIntensity;',
        'uniform float uTime;',
        'uniform float uActiveGlow;',
        'varying vec3 vNormal;',
        'varying vec3 vViewPos;',
        'varying vec3 vWorldPos;',
        'void main() {',
        '  vec3 vd = normalize(vViewPos);',
        '  float fresnel = pow(1.0 - abs(dot(vd, vNormal)), uFresnelPower);',
        '  float shimmer = 1.0 + 0.08 * sin(uTime * 2.0 + vNormal.x * 12.0);',
        '  float ripple1 = sin(vWorldPos.x * 4.0 + uTime * 0.8) * cos(vWorldPos.z * 3.5 + uTime * 0.6);',
        '  float ripple2 = sin(vWorldPos.x * 6.0 - uTime * 0.5 + 1.7) * cos(vWorldPos.z * 5.0 + uTime * 0.4);',
        '  float poolEffect = 0.5 + 0.3 * ripple1 + 0.2 * ripple2;',
        '  float electricPool = mix(1.0, poolEffect * 1.4 + 0.3, uActiveGlow);',
        '  float outerGlow = pow(fresnel, 1.2) * uActiveGlow;',
        '  vec3 glowColor = mix(uColor, vec3(1.0), outerGlow * 0.6);',
        '  float alpha = fresnel * uOpacity * shimmer * electricPool;',
        '  alpha += outerGlow * 0.35;',
        '  vec3 col = glowColor * (1.0 + fresnel * uGlowIntensity + outerGlow * 1.5);',
        '  gl_FragColor = vec4(col, alpha);',
        '}'
      ].join('\n');

      // Gateway shader (for L8)
      var gatewayFrag = [
        'uniform vec3 uColor;',
        'uniform float uOpacity;',
        'uniform float uTime;',
        'uniform float uActiveGlow;',
        'varying vec3 vNormal;',
        'varying vec3 vViewPos;',
        'varying vec3 vWorldPos;',
        'void main() {',
        '  vec3 vd = normalize(vViewPos);',
        '  float fresnel = pow(1.0 - abs(dot(vd, vNormal)), 2.5);',
        '  float pulse = 0.6 + 0.4 * sin(uTime * 3.0);',
        '  float energy = fresnel * pulse;',
        '  float scan = 0.5 + 0.5 * sin(vNormal.y * 20.0 + uTime * 4.0);',
        '  energy += scan * 0.15 * fresnel;',
        '  float ripple1 = sin(vWorldPos.x * 3.0 + uTime * 0.6) * cos(vWorldPos.z * 2.5 + uTime * 0.4);',
        '  float ripple2 = sin(vWorldPos.x * 5.0 - uTime * 0.35 + 2.1) * cos(vWorldPos.z * 4.0 + uTime * 0.3);',
        '  float poolEffect = 0.5 + 0.3 * ripple1 + 0.2 * ripple2;',
        '  float electricPool = mix(1.0, poolEffect * 1.6 + 0.2, uActiveGlow);',
        '  float outerGlow = pow(fresnel, 1.0) * uActiveGlow;',
        '  vec3 glowColor = mix(uColor, vec3(1.0, 0.95, 0.85), outerGlow * 0.5);',
        '  energy *= electricPool;',
        '  energy += outerGlow * 0.4;',
        '  vec3 col = glowColor * (1.0 + energy * 2.0 + outerGlow * 2.0);',
        '  gl_FragColor = vec4(col, energy * uOpacity + outerGlow * 0.3);',
        '}'
      ].join('\n');

      function initScene() {
        // Renderer
        renderer = new THREE.WebGLRenderer({
          alpha: true,
          antialias: !isMobile,
          powerPreference: 'high-performance'
        });
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, isMobile ? 1.5 : 2));
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setClearColor(0x0a0a0f, 1);
        renderer.toneMapping = THREE.ACESFilmicToneMapping;
        renderer.toneMappingExposure = 1.2;
        threeContainer.appendChild(renderer.domElement);

        // Scene & Camera
        scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0x0a0a0f, 0.035);
        camera = new THREE.PerspectiveCamera(40, window.innerWidth / window.innerHeight, 0.1, 100);
        camera.position.set(0, 1.07, 7.87);

        // Groups
        autoRotateGroup = new THREE.Group();
        parallaxGroup = new THREE.Group();
        scene.add(autoRotateGroup);
        autoRotateGroup.add(parallaxGroup);
        autoRotateGroup.position.y = 0.5;

        // Lighting: QInnovate colors
        scene.add(new THREE.AmbientLight(0x0a1a2a, 0.3));
        var keyLight = new THREE.PointLight(0x00e5ff, 2.0, 25);
        keyLight.position.set(4, 3, 5);
        scene.add(keyLight);
        var fillLight = new THREE.PointLight(0xb44aff, 1.2, 20);
        fillLight.position.set(-3, -2, 3);
        scene.add(fillLight);
        var rimLight = new THREE.PointLight(0x00e5ff, 1.5, 20);
        rimLight.position.set(0, 1, -5);
        scene.add(rimLight);

        // Shell geometry
        var shellGeo = new THREE.SphereGeometry(1, isMobile ? 32 : 64, isMobile ? 24 : 48);

        activeLayers.forEach(function(layer, idx) {
          var isGW = (idx === 0); // L8 = gateway
          var u = {
            uColor: { value: new THREE.Vector3(layer.c[0], layer.c[1], layer.c[2]) },
            uOpacity: { value: isGW ? 0.7 : 0.45 },
            uFresnelPower: { value: layer.fp },
            uGlowIntensity: { value: isGW ? 2.5 : 1.2 },
            uTime: { value: 0 },
            uActiveGlow: { value: 0.0 }
          };
          var mat = new THREE.ShaderMaterial({
            uniforms: u,
            vertexShader: fresnelVert,
            fragmentShader: isGW ? gatewayFrag : fresnelFrag,
            transparent: true,
            side: THREE.FrontSide,
            depthWrite: false,
            blending: THREE.AdditiveBlending,
          });
          var mesh = new THREE.Mesh(shellGeo, mat);
          mesh.scale.setScalar(layer.r);
          parallaxGroup.add(mesh);
          shellMeshes.push(mesh);
          shellUniforms.push(u);
        });

        // Ambient Dust (cyan/purple)
        var dustCount = isMobile ? 80 : 200;
        var dPos = new Float32Array(dustCount * 3);
        for (var i = 0; i < dustCount; i++) {
          dPos[i * 3]     = (Math.random() - 0.5) * 10;
          dPos[i * 3 + 1] = (Math.random() - 0.5) * 8;
          dPos[i * 3 + 2] = (Math.random() - 0.5) * 6;
        }
        var dustGeo = new THREE.BufferGeometry();
        dustGeo.setAttribute('position', new THREE.BufferAttribute(dPos, 3));
        // Alternate between cyan and purple dust
        dustCloud = new THREE.Points(dustGeo, new THREE.PointsMaterial({
          color: 0x00c8e5, size: 0.015, transparent: true, opacity: 0.3,
          depthWrite: false, blending: THREE.AdditiveBlending, sizeAttenuation: true,
        }));
        scene.add(dustCloud);

        clock = new THREE.Clock();
      }

      // Mouse parallax
      var mouseX = 0, mouseY = 0;
      document.addEventListener('mousemove', function(e) {
        mouseX = (e.clientX / window.innerWidth - 0.5) * 2;
        mouseY = (e.clientY / window.innerHeight - 0.5) * 2;
      });

      // Spring compression state
      var springCompress = 0;
      var springTarget = 0;
      var rippleWavePos = 0;
      var rippleIntensity = 0;

      window.addEventListener('wheel', function(e) {
        if (!running) return;
        if (window.scrollY < 10 && e.deltaY < 0) {
          var t01 = springTarget / 2.0;
          var scrollRate = 0.002 + t01 * t01 * 0.006;
          springTarget = Math.min(2.0, springTarget + Math.abs(e.deltaY) * scrollRate);
          if (springTarget > 0.3) {
            rippleWavePos += Math.abs(e.deltaY) * 0.008;
            rippleIntensity = Math.min(1, rippleIntensity + Math.abs(e.deltaY) * 0.015);
          }
        } else if (e.deltaY > 0) {
          springTarget = Math.max(0, springTarget - Math.abs(e.deltaY) * 0.006);
        }
      }, { passive: true });

      // Touch support for spring
      var touchStartY = 0;
      window.addEventListener('touchstart', function(e) {
        touchStartY = e.touches[0].clientY;
      }, { passive: true });
      window.addEventListener('touchmove', function(e) {
        if (!running) return;
        var dy = e.touches[0].clientY - touchStartY;
        touchStartY = e.touches[0].clientY;
        if (window.scrollY < 10 && dy > 0) {
          var t01t = springTarget / 2.0;
          var touchRate = 0.002 + t01t * t01t * 0.006;
          springTarget = Math.min(2.0, springTarget + dy * touchRate);
          if (springTarget > 0.3) {
            rippleWavePos += dy * 0.008;
            rippleIntensity = Math.min(1, rippleIntensity + dy * 0.015);
          }
        } else if (dy < 0) {
          springTarget = Math.max(0, springTarget + dy * 0.006);
        }
      }, { passive: true });

      // Resize handler
      function onResize() {
        if (!renderer) return;
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      }
      window.addEventListener('resize', onResize);

      // Animation loop
      function animate() {
        animId = requestAnimationFrame(animate);

        var t = clock.getElapsedTime();

        // Update shader time uniforms
        shellUniforms.forEach(function(u) { u.uTime.value = t; });

        // Auto-rotation
        var rotSpeed = 0.002;
        autoRotateGroup.rotation.y += rotSpeed;
        autoRotateGroup.rotation.x = Math.sin(t * 0.15) * 0.08;

        // Mouse parallax
        var parallaxStr = 1.0;
        if (springCompress > 0.05) {
          var springParallax = Math.min(1, springCompress * 2);
          parallaxStr = Math.max(parallaxStr, springParallax);
        }
        var tiltMultX = 0.20;
        var tiltMultY = 0.08;
        if (springCompress > 0.05) {
          var springTiltBoost = Math.min(1, springCompress * 2);
          tiltMultX = 2.0 + springTiltBoost * 1.0;
          tiltMultY = 0.25 + springTiltBoost * 0.2;
        }

        if (springCompress < 0.05) {
          var autoTiltX = Math.sin(t * 0.25) * 0.04 + mouseY * tiltMultX * parallaxStr;
          var autoTiltY = Math.sin(t * 0.15) * 0.01 + mouseX * tiltMultY * parallaxStr;
          parallaxGroup.rotation.x += (autoTiltX - parallaxGroup.rotation.x) * 0.06;
          parallaxGroup.rotation.y += (autoTiltY - parallaxGroup.rotation.y) * 0.04;
        } else {
          parallaxGroup.rotation.x *= 0.92;
          parallaxGroup.rotation.y *= 0.92;
        }

        // Spring physics
        if (springTarget > 0 && window.scrollY >= 10) springTarget = 0;
        springTarget *= 0.992;
        springCompress += (springTarget - springCompress) * 0.08;
        if (springCompress < 0.2) { rippleWavePos = 0; rippleIntensity = 0; }
        // Decay ripple intensity
        rippleIntensity *= 0.97;

        // Per-shell animation
        var stackSpacing = 0.4;
        var heroBreathing = (springCompress < 0.01);

        shellMeshes.forEach(function(mesh, i) {
          var origR = originalRadii[i];
          var layer = activeLayers[i];
          var isGW = (i === 0);
          var breathing = 1 + Math.sin(t * 0.6 + i * 0.5) * 0.006;

          // Stack Y position (morphed as disc stack)
          var stackY = (i - (totalLayers - 1) / 2) * stackSpacing;

          // Spring coil compression
          if (springCompress > 0.001 && i > 0) {
            var stepsAboveAnchor = i;
            var maxSteps = totalLayers - 1;
            var springRatio = (stepsAboveAnchor / maxSteps);
            springRatio = springRatio * springRatio;
            var anchorY = (0 - (totalLayers - 1) / 2) * stackSpacing;
            var pullAmount = (stackY - anchorY) * springRatio * springCompress;
            stackY -= pullAmount;
          }

          // Tunnel perspective growth during compression
          var scaleExtra = 1.0;
          if (springCompress > 0.01) {
            var depthRatio = i / (totalLayers - 1);
            var baseGrow = 0.25;
            var extraGrow = 0.45;
            scaleExtra = 1 + springCompress * (baseGrow + depthRatio * extraGrow);
          }

          // Morph: always show as slightly flattened discs (like ONI hero state)
          var mp = 0.874; // morphed disc state
          var discScaleY = origR * breathing * (1 - mp * 0.92);
          var stackScaleXZ = origR * breathing * scaleExtra;

          mesh.scale.set(stackScaleXZ, discScaleY, stackScaleXZ);
          mesh.position.set(0, stackY * mp, 0);

          // === SPHERE FORMATION at peak compression ===
          if (springCompress > 0.6) {
            var sphereBlend = Math.min(1, (springCompress - 0.6) / 0.4);
            sphereBlend = sphereBlend * sphereBlend;

            // Y convergence
            var centerY = 0;
            mesh.position.y += (centerY - mesh.position.y) * sphereBlend;

            // X/Z convergence
            mesh.position.x *= (1 - sphereBlend * 0.8);
            mesh.position.z *= (1 - sphereBlend * 0.8);

            // Shape: disc to sphere
            var currentXZ = mesh.scale.x;
            var currentY = mesh.scale.y;
            mesh.scale.y = currentY + (currentXZ - currentY) * sphereBlend;

            // Scale equalization to concentric radii
            var sphereR = origR * breathing;
            mesh.scale.x += (sphereR - mesh.scale.x) * sphereBlend * 0.7;
            mesh.scale.y += (sphereR - mesh.scale.y) * sphereBlend * 0.7;
            mesh.scale.z += (sphereR - mesh.scale.z) * sphereBlend * 0.7;

            // Remove tilt
            mesh.rotation.x *= (1 - sphereBlend);
            mesh.rotation.y *= (1 - sphereBlend);
          }

          // Per-layer mouse parallax during spring
          if (springCompress > 0.05) {
            var l14Idx = totalLayers - 1;
            var distFromCenter = Math.abs(i - l14Idx);
            var layerParallax = (distFromCenter / l14Idx) * Math.min(1, springCompress * 2);
            mesh.position.x += mouseX * layerParallax * 0.4;
            mesh.position.y += -mouseY * layerParallax * 0.3;
          }

          // White ripple wave during spring scroll
          if (rippleIntensity > 0.01 && springCompress > 0.3 && shellUniforms[i]) {
            var layerPos = (totalLayers - 1 - i) / (totalLayers - 1);
            var waveFront = (rippleWavePos * 0.8) % 1.4;
            var dist = Math.abs(layerPos - waveFront);
            dist = Math.min(dist, Math.abs(layerPos - waveFront + 1.4));
            dist = Math.min(dist, Math.abs(layerPos - waveFront - 1.4));
            var wave = Math.exp(-dist * dist * 40) * rippleIntensity;
            var c = shellUniforms[i].uColor.value;
            c.x += (1.0 - c.x) * wave * 0.7;
            c.y += (1.0 - c.y) * wave * 0.7;
            c.z += (1.0 - c.z) * wave * 0.7;
            shellUniforms[i].uGlowIntensity.value += wave * 4.0;
            shellUniforms[i].uOpacity.value += wave * 0.3;
          }

          // === HERO BREATHING (only when spring is not compressed) ===
          if (heroBreathing) {
            var stepsFromTop = (totalLayers - 1) - i;
            var wavePhase = stepsFromTop * 0.4;
            var glowPulse = (Math.sin(t * 0.6 - wavePhase) + 1) * 0.5;
            glowPulse = glowPulse * glowPulse;
            glowPulse *= 0.35;

            var bcc = layer.c;
            if (isGW) {
              // L8: cycle between cyan shades
              var l8Cycle = (Math.sin(t * 0.25) + 1.0) * 0.5;
              var l8A = [0.00, 0.55, 0.75];
              var l8B = [0.00, 0.70, 0.65];
              bcc = [
                l8A[0] + (l8B[0] - l8A[0]) * l8Cycle,
                l8A[1] + (l8B[1] - l8A[1]) * l8Cycle,
                l8A[2] + (l8B[2] - l8A[2]) * l8Cycle
              ];
            }

            var gp = isGW ? 0 : glowPulse;

            // Color intensity wave
            var wavePos2 = (Math.sin(t * 0.3) + 1.0) * 0.5 * (totalLayers - 1);
            var waveDist = Math.abs(i - wavePos2);
            var colorBoost = Math.max(0, 1.0 - waveDist * 0.25);
            colorBoost = colorBoost * 0.6;
            var cb = isGW ? 0 : colorBoost;

            shellUniforms[i].uColor.value.set(
              bcc[0] + (1.0 - bcc[0]) * gp + (bcc[0] - 0.5) * cb * 0.5,
              bcc[1] + (1.0 - bcc[1]) * gp + (bcc[1] - 0.5) * cb * 0.5,
              bcc[2] + (1.0 - bcc[2]) * gp + (bcc[2] - 0.5) * cb * 0.5
            );
            shellUniforms[i].uGlowIntensity.value = 1.5 + glowPulse * 2.0 + cb * 1.5;
            shellUniforms[i].uOpacity.value = 0.6 + glowPulse * 0.2 + cb * 0.15;

            // L14 + L8: electric pool effect
            if (i === totalLayers - 1 || isGW) {
              shellUniforms[i].uActiveGlow.value = 0.3 + glowPulse * 0.4;
            }

            // Pool ripple scale
            var ripplePhase = i * 0.45;
            var ripple1 = Math.sin(t * 0.5 - ripplePhase) * 0.004;
            var ripple2 = Math.sin(t * 0.8 - ripplePhase * 1.3) * 0.002;
            var rippleScale = 1.0 + ripple1 + ripple2;
            mesh.scale.x *= rippleScale;
            mesh.scale.z *= rippleScale;

            // Accordion Y breathing
            var layerRatio = i / (totalLayers - 1);
            var expCompress = Math.pow(layerRatio, 2.5);
            var accPhase = i * 0.35;
            var accBreathAmp = (0.012 + expCompress * 0.16);
            var accBreath = Math.sin(t * 0.4 - accPhase) * accBreathAmp;
            mesh.position.y += accBreath;

            // Scale breathing: bottom layers scale up as top layers compress
            var invRatio = 1.0 - layerRatio;
            var compressAmt = Math.abs(accBreath) / 0.30;
            var scaleBoostVal = 1.0 + (1.0 - compressAmt) * invRatio * 0.06;
            mesh.scale.x *= scaleBoostVal;
            mesh.scale.z *= scaleBoostVal;

          } else {
            // Spring active: color cycling (L14 -> L8 magenta/teal spectrum)
            if (springCompress > 0.01) {
              var stepsFromL14 = (totalLayers - 1) - i;
              var layerPhase = stepsFromL14 * 0.15;
              var l14SpeedBoost = (stepsFromL14 === 0) ? springCompress * springCompress * 1.5 : 0;
              var mtPos = (springCompress * 0.6 + t * (0.25 + l14SpeedBoost) + layerPhase) % 1.0;

              // Spectrum: cyan -> purple -> magenta -> cyan
              var specR, specG, specB;
              if (mtPos < 0.33) {
                var st = mtPos / 0.33;
                specR = 0.00 + st * 0.71; specG = 0.90 - st * 0.61; specB = 1.00;
              } else if (mtPos < 0.66) {
                var st = (mtPos - 0.33) / 0.33;
                specR = 0.71 + st * 0.29; specG = 0.29 - st * 0.09; specB = 1.00 - st * 0.20;
              } else {
                var st = (mtPos - 0.66) / 0.34;
                specR = 1.00 - st * 1.00; specG = 0.20 + st * 0.70; specB = 0.80 + st * 0.20;
              }

              var blend = Math.min(1, springCompress * 1.5);
              shellUniforms[i].uColor.value.set(
                layer.c[0] + (specR - layer.c[0]) * blend,
                layer.c[1] + (specG - layer.c[1]) * blend,
                layer.c[2] + (specB - layer.c[2]) * blend
              );

              // L14 pulsing glow
              if (stepsFromL14 === 0 && springCompress > 0.3) {
                var l14PulseSpeed = 2.0 + springCompress * springCompress * 6.0;
                var l14Pulse = (Math.sin(t * l14PulseSpeed) + 1.0) * 0.5;
                shellUniforms[i].uGlowIntensity.value += l14Pulse * (1.0 + springCompress * 1.5);
                shellUniforms[i].uActiveGlow.value = Math.max(shellUniforms[i].uActiveGlow.value, l14Pulse * springCompress * 0.4);
              }

              // L8: scale grows with compression + spectrum
              if (isGW && springCompress > 0.01) {
                var l8SpringGrow = 1 + springCompress * 0.35;
                mesh.scale.x *= l8SpringGrow;
                mesh.scale.z *= l8SpringGrow;
                var targetY = mesh.scale.x;
                mesh.scale.y += (targetY - mesh.scale.y) * springCompress;
                shellUniforms[i].uGlowIntensity.value = 2.5 + springCompress * 2.0;
              }
            }
          }
        });

        // Dust drift
        dustCloud.rotation.y = t * 0.02;
        dustCloud.rotation.x = Math.sin(t * 0.1) * 0.05;

        renderer.render(scene, camera);
      }

      function start() {
        if (running) return;
        running = true;
        threeContainer.style.display = '';
        if (!renderer) initScene();
        clock.start();
        animate();
      }

      function stop() {
        if (!running) return;
        running = false;
        if (animId) {
          cancelAnimationFrame(animId);
          animId = null;
        }
        if (clock) clock.stop();
        // Reset spring state
        springCompress = 0;
        springTarget = 0;
        // Render one static frame so the hero has a background
        if (renderer) renderer.render(scene, camera);
      }

      function renderStaticFrame() {
        if (!renderer) initScene();
        renderer.render(scene, camera);
      }

      // Always init and render one static frame for the hero background
      if (document.body.classList.contains('effects-enabled')) {
        start();
      } else {
        renderStaticFrame();
      }

      window.addEventListener('effects-on', start);
      window.addEventListener('effects-off', stop);
    })();

    /* =============================================
       NAV SCROLL EFFECT
       ============================================= */
    window.addEventListener('scroll', function() {
      document.getElementById('nav').classList.toggle('scrolled', window.scrollY > 50);
    });

    /* =============================================
       MOBILE NAV
       ============================================= */
    var hamburger = document.getElementById('hamburger');
    var mobileNav = document.getElementById('mobile-nav');

    hamburger.addEventListener('click', function() {
      hamburger.classList.toggle('active');
      mobileNav.classList.toggle('open');
      document.body.style.overflow = mobileNav.classList.contains('open') ? 'hidden' : '';
    });

    function closeMobileNav() {
      hamburger.classList.remove('active');
      mobileNav.classList.remove('open');
      document.body.style.overflow = '';
    }
  </script>

  <!-- Cloudflare Web Analytics --><script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "7e92b0e996474c9e9502b816aa36beed"}'></script><!-- End Cloudflare Web Analytics -->

</body>
</html>
